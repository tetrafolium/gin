---
inspecode:

  global:

  tools:

    fortify:
      options:
        --commands:
          - GO_ARCHIVE='https://dl.google.com/go'
          - GO_VERSION='go1.15.13' OS_ARCH='linux-amd64'
          - GO_TARBALL="${GO_VERSION}.${OS_ARCH}.tar.gz"
          - GO_SHA256='3d3beec5fc66659018e09f40abb7274b10794229ba7c1e8bdb7d8ca77b656a13'
          - curl --silent -o "/tmp/${GO_TARBALL}" "${GO_ARCHIVE}/${GO_TARBALL}"
          - test "${GO_SHA256}" = "$(sha256sum "/tmp/${GO_TARBALL}" | sed -e 's| .*$||')" || ( echo "checksum not match" && exit 1 )
          - sudo tar -C /usr/local -xzf "/tmp/${GO_TARBALL}"
          - rm -f "/tmp/${GO_TARBALL}"
          - GOROOT='/usr/local/go'
          - ls -la "${GOROOT}/bin"
          - PATH="${PATH}:${GOROOT}/bin"
          - echo +++ $(go version)
          # - cd /home/rocro
          # - sourceanalyzer -b build_id -clean
          - cd /home/rocro/src/github.com/tetrafolium/gin
          - make GO="sourceanalyzer -b build_id go" test
        --work-dir: /
      thresholds: {num-issues: 999}
